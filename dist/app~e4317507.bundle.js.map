{"version":3,"file":"app~e4317507.bundle.js","mappings":"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","sources":["webpack://restaurant-apps/./src/scripts/routes/routes.js","webpack://restaurant-apps/./src/scripts/routes/url-parser.js","webpack://restaurant-apps/./src/scripts/utils/drawer-initiator.js","webpack://restaurant-apps/./src/scripts/utils/footer-tools-initiator.js","webpack://restaurant-apps/./src/scripts/utils/like-button-presenter.js","webpack://restaurant-apps/./src/scripts/utils/sw-register.js","webpack://restaurant-apps/./src/scripts/utils/notification-helper.js","webpack://restaurant-apps/./src/scripts/utils/websocket-initiator.js"],"sourcesContent":["import Home from '../views/pages/home';\r\n\r\nimport Detail from '../views/pages/detail';\r\nimport Like from '../views/pages/like';\r\n\r\nconst routes = {\r\n  '/': Home,\r\n  '/home': Home,\r\n\r\n  '/detail/:id': Detail,\r\n  '/like': Like,\r\n};\r\n\r\nexport default routes;\r\n","const UrlParser = {\r\n  parseActiveUrlWithCombiner() {\r\n    const url = window.location.hash.slice(1).toLowerCase();\r\n    const splitedUrl = this._urlSplitter(url);\r\n    return this._urlCombiner(splitedUrl);\r\n  },\r\n\r\n  parseActiveUrlWithoutCombiner() {\r\n    const url = window.location.hash.slice(1).toLowerCase();\r\n    return this._urlSplitter(url);\r\n  },\r\n\r\n  _urlSplitter(url) {\r\n    const urlsSplits = url.split('/');\r\n    return {\r\n      resource: urlsSplits[1] || null,\r\n      id: urlsSplits[2] || null,\r\n      verb: urlsSplits[3] || null,\r\n    };\r\n  },\r\n\r\n  _urlCombiner(splitedUrl) {\r\n    return (splitedUrl.resource ? `/${splitedUrl.resource}` : '/')\r\n      + (splitedUrl.id ? '/:id' : '')\r\n      + (splitedUrl.verb ? `/${splitedUrl.verb}` : '');\r\n  },\r\n};\r\n\r\nexport default UrlParser;\r\n","const DrawerInitiator = {\r\n  init({ button, drawer, content }) {\r\n    button.addEventListener('click', (event) => {\r\n      event.preventDefault();\r\n      this._toggleDrawer(event, drawer);\r\n    });\r\n\r\n    content.addEventListener('click', (event) => {\r\n      this._closeDrawer(event, drawer);\r\n    });\r\n  },\r\n\r\n  _toggleDrawer(event, drawer) {\r\n    event.stopPropagation();\r\n    drawer.classList.toggle('open');\r\n  },\r\n\r\n  _closeDrawer(event, drawer) {\r\n    event.stopPropagation();\r\n    drawer.classList.remove('open');\r\n  },\r\n};\r\n\r\nexport default DrawerInitiator;\r\n","const FooterToolsInitiator = {\r\n  async init({ subscribeButton, unsubscribeButton }) {\r\n    this._subscribeButton = subscribeButton;\r\n    this._unsubscribeButton = unsubscribeButton;\r\n    this._registrationServiceWorker = null;\r\n\r\n    if ('serviceWorker' in navigator) {\r\n      this._registrationServiceWorker = await navigator.serviceWorker.getRegistration();\r\n    }\r\n\r\n    await this._initialListener();\r\n    await this._initialState();\r\n  },\r\n\r\n  async _initialListener() {\r\n    this._subscribeButton.addEventListener('click', (event) => {\r\n      this._subscribePushMessage(event);\r\n    });\r\n\r\n    this._unsubscribeButton.addEventListener('click', (event) => {\r\n      this._unsubscribePushMessage(event);\r\n    });\r\n  },\r\n\r\n  // eslint-disable-next-line no-empty-function\r\n  async _initialState() {},\r\n\r\n  async _subscribePushMessage(event) {\r\n    event.stopPropagation();\r\n    console.log('_subscribePushMessage');\r\n    // TODO: Do subscribe to push message\r\n  },\r\n\r\n  async _unsubscribePushMessage(event) {\r\n    event.stopPropagation();\r\n    console.log('_unsubscribePushMessage');\r\n    // TODO: Do unsubscribe to push message\r\n  },\r\n\r\n  _urlB64ToUint8Array: (base64String) => {\r\n    // eslint-disable-next-line no-mixed-operators\r\n    const padding = '='.repeat((4 - base64String.length % 4) % 4);\r\n    const base64 = (base64String + padding)\r\n      .replace(/-/g, '+')\r\n      .replace(/_/g, '/');\r\n    const rawData = window.atob(base64);\r\n    const outputArray = new Uint8Array(rawData.length);\r\n\r\n    // eslint-disable-next-line no-plusplus\r\n    for (let i = 0; i < rawData.length; i++) {\r\n      outputArray[i] = rawData.charCodeAt(i);\r\n    }\r\n    return outputArray;\r\n  },\r\n\r\n  async _sendPostToServer(url, data) {\r\n    const response = await fetch(url, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify(data),\r\n    });\r\n\r\n    return response.json();\r\n  },\r\n\r\n  _isSubscribedToServerForHiddenSubscribeButton(state = false) {\r\n    if (state) {\r\n      this._subscribeButton.style.display = 'none';\r\n      this._unsubscribeButton.style.display = 'inline-block';\r\n    } else {\r\n      this._subscribeButton.style.display = 'inline-block';\r\n      this._unsubscribeButton.style.display = 'none';\r\n    }\r\n  },\r\n};\r\n\r\nexport default FooterToolsInitiator;\r\n","import { createLikeButtonTemplate, createLikedButtonTemplate } from '../views/templates/template-creator';\r\n\r\nconst LikeButtonPresenter = {\r\n  async init({ likeButtonContainer, favoriteRestaurants, restaurant }) {\r\n    this._likeButtonContainer = likeButtonContainer;\r\n    this._restaurant = restaurant;\r\n    this._favoriteRestaurants = favoriteRestaurants;\r\n\r\n    await this._renderButton();\r\n  },\r\n\r\n  async _renderButton() {\r\n    const { id } = this._restaurant;\r\n\r\n    if (await this._isrestaurantExist(id)) {\r\n      this._renderLiked();\r\n    } else {\r\n      this._renderLike();\r\n    }\r\n  },\r\n\r\n  async _isrestaurantExist(id) {\r\n    const restaurant = await this._favoriteRestaurants.getRestaurant(id);\r\n    return !!restaurant;\r\n  },\r\n\r\n  _renderLike() {\r\n    this._likeButtonContainer.innerHTML = createLikeButtonTemplate();\r\n\r\n    const likeButton = document.querySelector('#likeButton');\r\n    likeButton.addEventListener('click', async () => {\r\n      await this._favoriteRestaurants.putRestaurant(this._restaurant);\r\n      this._renderButton();\r\n    });\r\n  },\r\n\r\n  _renderLiked() {\r\n    this._likeButtonContainer.innerHTML = createLikedButtonTemplate();\r\n\r\n    const likeButton = document.querySelector('#likeButton');\r\n    likeButton.addEventListener('click', async () => {\r\n      await this._favoriteRestaurants.deleteRestaurant(this._restaurant.id);\r\n      this._renderButton();\r\n    });\r\n  },\r\n};\r\n\r\nexport default LikeButtonPresenter;\r\n","import * as WorkboxWindow from 'workbox-window';\r\n\r\nconst swRegister = async () => {\r\n  if (!('serviceWorker' in navigator)) {\r\n    console.log('Service Worker not supported in the browser');\r\n    return;\r\n  }\r\n  const wb = new WorkboxWindow.Workbox('./sw.bundle.js');\r\n  try {\r\n    await wb.register('./sw.bundle.js');\r\n    console.log('Service worker registered');\r\n  } catch (error) {\r\n    console.log('Failed to register service worker', error);\r\n  }\r\n};\r\n\r\nexport default swRegister;\r\n","const NotificationHelper = {\r\n  sendNotification({ title, options }) {\r\n    if (!this._checkAvailability()) {\r\n      console.log('Notification not supported in this browser');\r\n      return;\r\n    }\r\n\r\n    if (!this._checkPermission()) {\r\n      console.log('User did not yet granted permission');\r\n      this._requestPermission();\r\n      return;\r\n    }\r\n\r\n    this._showNotification({ title, options });\r\n  },\r\n\r\n  _checkAvailability() {\r\n    return 'Notification' in window;\r\n  },\r\n\r\n  _checkPermission() {\r\n    return Notification.permission === 'granted';\r\n  },\r\n\r\n  async _requestPermission() {\r\n    const status = await Notification.requestPermission();\r\n\r\n    if (status === 'denied') {\r\n      console.log('Notification Denied');\r\n    }\r\n\r\n    if (status === 'default') {\r\n      console.log('Permission closed');\r\n    }\r\n  },\r\n\r\n  async _showNotification({ title, options }) {\r\n    const serviceWorkerRegistration = await navigator.serviceWorker.ready;\r\n    serviceWorkerRegistration.showNotification(title, options);\r\n  },\r\n};\r\n\r\nexport default NotificationHelper;\r\n","import NotificationHelper from './notification-helper';\r\nimport CONFIG from '../globals/config';\r\n\r\nconst WebSocketInitiator = {\r\n  init(url) {\r\n    const webSocket = new WebSocket(url);\r\n    webSocket.onmessage = this._onMessageHandler;\r\n  },\r\n\r\n  _onMessageHandler(message) {\r\n    const restaurant = JSON.parse(message.data);\r\n\r\n    NotificationHelper.sendNotification({\r\n      name: `${restaurant.name} is open !`,\r\n      options: {\r\n        body: restaurant.city,\r\n        image: `${CONFIG.BASE_IMAGE_URL + restaurant.pictureId}`,\r\n      },\r\n    });\r\n  },\r\n};\r\nexport default WebSocketInitiator;\r\n"],"names":["Home","Detail","Like","parseActiveUrlWithCombiner","url","window","location","hash","slice","toLowerCase","splitedUrl","this","_urlSplitter","_urlCombiner","parseActiveUrlWithoutCombiner","urlsSplits","split","resource","id","verb","init","button","drawer","content","addEventListener","event","preventDefault","_toggleDrawer","_closeDrawer","stopPropagation","classList","toggle","remove","subscribeButton","unsubscribeButton","_subscribeButton","_unsubscribeButton","_registrationServiceWorker","navigator","serviceWorker","getRegistration","_initialListener","_initialState","_subscribePushMessage","_unsubscribePushMessage","console","log","_urlB64ToUint8Array","base64String","base64","repeat","length","replace","rawData","atob","outputArray","Uint8Array","i","charCodeAt","_sendPostToServer","data","fetch","method","headers","body","JSON","stringify","response","json","_isSubscribedToServerForHiddenSubscribeButton","state","style","display","likeButtonContainer","favoriteRestaurants","restaurant","_likeButtonContainer","_restaurant","_favoriteRestaurants","_renderButton","_isrestaurantExist","_renderLiked","_renderLike","getRestaurant","innerHTML","createLikeButtonTemplate","document","querySelector","putRestaurant","createLikedButtonTemplate","deleteRestaurant","wb","WorkboxWindow","register","sendNotification","title","options","_checkAvailability","_checkPermission","_showNotification","_requestPermission","Notification","permission","requestPermission","status","ready","showNotification","WebSocket","onmessage","_onMessageHandler","message","parse","NotificationHelper","name","city","image","CONFIG","pictureId"],"sourceRoot":""}